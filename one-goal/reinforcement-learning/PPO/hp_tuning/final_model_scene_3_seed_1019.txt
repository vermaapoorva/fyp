2023-05-31 06:49:06.434774: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
Training final model for scene 3 with seed 1019
Training on scene: teapot_scene.ttt
Bottleneck x: 0.0573
Bottleneck y: -0.0254
Bottleneck z: 0.752
Bottleneck z angle: 2.871
Hyperparameters: {'net_arch': [128, 128], 'batch_size': 4096, 'n_steps': 2048}
/vol/bitbucket/av1019/fypenv/lib/python3.10/site-packages/gymnasium/spaces/box.py:130: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  gym.logger.warn(f"Box bound precision lowered by casting to {self.dtype}")
/vol/bitbucket/av1019/fypenv/lib/python3.10/site-packages/gymnasium/spaces/box.py:130: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  gym.logger.warn(f"Box bound precision lowered by casting to {self.dtype}")
/vol/bitbucket/av1019/fypenv/lib/python3.10/site-packages/gymnasium/spaces/box.py:130: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  gym.logger.warn(f"Box bound precision lowered by casting to {self.dtype}")
/vol/bitbucket/av1019/fypenv/lib/python3.10/site-packages/gymnasium/spaces/box.py:130: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  gym.logger.warn(f"Box bound precision lowered by casting to {self.dtype}")
/vol/bitbucket/av1019/fypenv/lib/python3.10/site-packages/gymnasium/spaces/box.py:130: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  gym.logger.warn(f"Box bound precision lowered by casting to {self.dtype}")
/vol/bitbucket/av1019/fypenv/lib/python3.10/site-packages/gymnasium/spaces/box.py:130: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  gym.logger.warn(f"Box bound precision lowered by casting to {self.dtype}")
/vol/bitbucket/av1019/fypenv/lib/python3.10/site-packages/gymnasium/spaces/box.py:130: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  gym.logger.warn(f"Box bound precision lowered by casting to {self.dtype}")
/vol/bitbucket/av1019/fypenv/lib/python3.10/site-packages/gymnasium/spaces/box.py:130: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  gym.logger.warn(f"Box bound precision lowered by casting to {self.dtype}")
/vol/bitbucket/av1019/fypenv/lib/python3.10/site-packages/gymnasium/spaces/box.py:130: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  gym.logger.warn(f"Box bound precision lowered by casting to {self.dtype}")
/vol/bitbucket/av1019/fypenv/lib/python3.10/site-packages/gymnasium/spaces/box.py:130: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  gym.logger.warn(f"Box bound precision lowered by casting to {self.dtype}")
/vol/bitbucket/av1019/fypenv/lib/python3.10/site-packages/gymnasium/spaces/box.py:130: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  gym.logger.warn(f"Box bound precision lowered by casting to {self.dtype}")
/vol/bitbucket/av1019/fypenv/lib/python3.10/site-packages/gymnasium/spaces/box.py:130: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  gym.logger.warn(f"Box bound precision lowered by casting to {self.dtype}")
/vol/bitbucket/av1019/fypenv/lib/python3.10/site-packages/gymnasium/spaces/box.py:130: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  gym.logger.warn(f"Box bound precision lowered by casting to {self.dtype}")
/vol/bitbucket/av1019/fypenv/lib/python3.10/site-packages/gymnasium/spaces/box.py:130: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  gym.logger.warn(f"Box bound precision lowered by casting to {self.dtype}")
/vol/bitbucket/av1019/fypenv/lib/python3.10/site-packages/gymnasium/spaces/box.py:130: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  gym.logger.warn(f"Box bound precision lowered by casting to {self.dtype}")
/vol/bitbucket/av1019/fypenv/lib/python3.10/site-packages/gymnasium/spaces/box.py:130: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  gym.logger.warn(f"Box bound precision lowered by casting to {self.dtype}")
error: library ( /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so ) load: "Cannot load library /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so: (libstd_srvs__rosidl_typesupport_cpp.so: cannot open shared object file: No such file or directory)"
error: library ( /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so ) load: "Cannot load library /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so: (libstd_srvs__rosidl_typesupport_cpp.so: cannot open shared object file: No such file or directory)"
error: library ( /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so ) load: "Cannot load library /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so: (libstd_srvs__rosidl_typesupport_cpp.so: cannot open shared object file: No such file or directory)"
error: library ( /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so ) load: "Cannot load library /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so: (libstd_srvs__rosidl_typesupport_cpp.so: cannot open shared object file: No such file or directory)"
error: library ( /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so ) load: "Cannot load library /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so: (libstd_srvs__rosidl_typesupport_cpp.so: cannot open shared object file: No such file or directory)"
error: library ( /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so ) load: "Cannot load library /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so: (libstd_srvs__rosidl_typesupport_cpp.so: cannot open shared object file: No such file or directory)"
error: library ( /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so ) load: "Cannot load library /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so: (libstd_srvs__rosidl_typesupport_cpp.so: cannot open shared object file: No such file or directory)"
error: library ( /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so ) load: "Cannot load library /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so: (libstd_srvs__rosidl_typesupport_cpp.so: cannot open shared object file: No such file or directory)"
error: library ( /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so ) load: "Cannot load library /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so: (libstd_srvs__rosidl_typesupport_cpp.so: cannot open shared object file: No such file or directory)"
error: library ( /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so ) load: "Cannot load library /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so: (libstd_srvs__rosidl_typesupport_cpp.so: cannot open shared object file: No such file or directory)"
error: library ( /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so ) load: "Cannot load library /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so: (libstd_srvs__rosidl_typesupport_cpp.so: cannot open shared object file: No such file or directory)"
error: library ( /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so ) load: "Cannot load library /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so: (libstd_srvs__rosidl_typesupport_cpp.so: cannot open shared object file: No such file or directory)"
error: library ( /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so ) load: "Cannot load library /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so: (libstd_srvs__rosidl_typesupport_cpp.so: cannot open shared object file: No such file or directory)"
error: library ( /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so ) load: "Cannot load library /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so: (libstd_srvs__rosidl_typesupport_cpp.so: cannot open shared object file: No such file or directory)"
error: library ( /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so ) load: "Cannot load library /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so: (libstd_srvs__rosidl_typesupport_cpp.so: cannot open shared object file: No such file or directory)"
error: library ( /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so ) load: "Cannot load library /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so: (libstd_srvs__rosidl_typesupport_cpp.so: cannot open shared object file: No such file or directory)"
/vol/bitbucket/av1019/fypenv/lib/python3.10/site-packages/gymnasium/spaces/box.py:130: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  gym.logger.warn(f"Box bound precision lowered by casting to {self.dtype}")
error: library ( /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so ) load: "Cannot load library /homes/av1019/FYP/fyp/CoppeliaSim_Edu_V4_5_1_rev0_Ubuntu22_04/libsimExtROS2.so: (libstd_srvs__rosidl_typesupport_cpp.so: cannot open shared object file: No such file or directory)"
Using cuda device
Logging to /vol/bitbucket/av1019/PPO/tensorboard_logs/final_model_scene_3_seed_1019/PPO_1
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 500      |
|    ep_rew_mean     | -288     |
| time/              |          |
|    fps             | 231      |
|    iterations      | 1        |
|    time_elapsed    | 141      |
|    total_timesteps | 32768    |
---------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 500         |
|    ep_rew_mean          | -240        |
| time/                   |             |
|    fps                  | 236         |
|    iterations           | 2           |
|    time_elapsed         | 276         |
|    total_timesteps      | 65536       |
| train/                  |             |
|    approx_kl            | 0.005274477 |
|    clip_fraction        | 0.0531      |
|    clip_range           | 0.2         |
|    entropy_loss         | -5.67       |
|    explained_variance   | -0.00928    |
|    learning_rate        | 0.0003      |
|    loss                 | 2.13        |
|    n_updates            | 10          |
|    policy_gradient_loss | -0.00436    |
|    std                  | 0.996       |
|    value_loss           | 9.86        |
-----------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 500          |
|    ep_rew_mean          | -192         |
| time/                   |              |
|    fps                  | 240          |
|    iterations           | 3            |
|    time_elapsed         | 409          |
|    total_timesteps      | 98304        |
| train/                  |              |
|    approx_kl            | 0.0047353236 |
|    clip_fraction        | 0.036        |
|    clip_range           | 0.2          |
|    entropy_loss         | -5.66        |
|    explained_variance   | 0.438        |
|    learning_rate        | 0.0003       |
|    loss                 | 5.23         |
|    n_updates            | 20           |
|    policy_gradient_loss | -0.00276     |
|    std                  | 0.995        |
|    value_loss           | 18           |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 500          |
|    ep_rew_mean          | -162         |
| time/                   |              |
|    fps                  | 242          |
|    iterations           | 4            |
|    time_elapsed         | 540          |
|    total_timesteps      | 131072       |
| train/                  |              |
|    approx_kl            | 0.0046672025 |
|    clip_fraction        | 0.0343       |
|    clip_range           | 0.2          |
|    entropy_loss         | -5.66        |
|    explained_variance   | 0.497        |
|    learning_rate        | 0.0003       |
|    loss                 | 4.96         |
|    n_updates            | 30           |
|    policy_gradient_loss | -0.00305     |
|    std                  | 0.995        |
|    value_loss           | 13.6         |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 500          |
|    ep_rew_mean          | -146         |
| time/                   |              |
|    fps                  | 243          |
|    iterations           | 5            |
|    time_elapsed         | 673          |
|    total_timesteps      | 163840       |
| train/                  |              |
|    approx_kl            | 0.0046527563 |
|    clip_fraction        | 0.0376       |
|    clip_range           | 0.2          |
|    entropy_loss         | -5.65        |
|    explained_variance   | 0.575        |
|    learning_rate        | 0.0003       |
|    loss                 | 4.34         |
|    n_updates            | 40           |
|    policy_gradient_loss | -0.00379     |
|    std                  | 0.994        |
|    value_loss           | 10.5         |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 500          |
|    ep_rew_mean          | -145         |
| time/                   |              |
|    fps                  | 243          |
|    iterations           | 6            |
|    time_elapsed         | 807          |
|    total_timesteps      | 196608       |
| train/                  |              |
|    approx_kl            | 0.0054838127 |
|    clip_fraction        | 0.0365       |
|    clip_range           | 0.2          |
|    entropy_loss         | -5.64        |
|    explained_variance   | 0.61         |
|    learning_rate        | 0.0003       |
|    loss                 | 4.05         |
|    n_updates            | 50           |
|    policy_gradient_loss | -0.00304     |
|    std                  | 0.99         |
|    value_loss           | 8.89         |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 500          |
|    ep_rew_mean          | -139         |
| time/                   |              |
|    fps                  | 243          |
|    iterations           | 7            |
|    time_elapsed         | 940          |
|    total_timesteps      | 229376       |
| train/                  |              |
|    approx_kl            | 0.0037670732 |
|    clip_fraction        | 0.0218       |
|    clip_range           | 0.2          |
|    entropy_loss         | -5.63        |
|    explained_variance   | 0.667        |
|    learning_rate        | 0.0003       |
|    loss                 | 3.64         |
|    n_updates            | 60           |
|    policy_gradient_loss | -0.00264     |
|    std                  | 0.987        |
|    value_loss           | 8.82         |
------------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 500         |
|    ep_rew_mean          | -138        |
| time/                   |             |
|    fps                  | 244         |
|    iterations           | 8           |
|    time_elapsed         | 1072        |
|    total_timesteps      | 262144      |
| train/                  |             |
|    approx_kl            | 0.003696974 |
|    clip_fraction        | 0.0265      |
|    clip_range           | 0.2         |
|    entropy_loss         | -5.62       |
|    explained_variance   | 0.482       |
|    learning_rate        | 0.0003      |
|    loss                 | 7.84        |
|    n_updates            | 70          |
|    policy_gradient_loss | -0.00239    |
|    std                  | 0.986       |
|    value_loss           | 20          |
-----------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 500          |
|    ep_rew_mean          | -129         |
| time/                   |              |
|    fps                  | 244          |
|    iterations           | 9            |
|    time_elapsed         | 1204         |
|    total_timesteps      | 294912       |
| train/                  |              |
|    approx_kl            | 0.0042721336 |
|    clip_fraction        | 0.027        |
|    clip_range           | 0.2          |
|    entropy_loss         | -5.62        |
|    explained_variance   | 0.693        |
|    learning_rate        | 0.0003       |
|    loss                 | 4.76         |
|    n_updates            | 80           |
|    policy_gradient_loss | -0.00271     |
|    std                  | 0.985        |
|    value_loss           | 8.37         |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 500          |
|    ep_rew_mean          | -126         |
| time/                   |              |
|    fps                  | 245          |
|    iterations           | 10           |
|    time_elapsed         | 1337         |
|    total_timesteps      | 327680       |
| train/                  |              |
|    approx_kl            | 0.0028651683 |
|    clip_fraction        | 0.0168       |
|    clip_range           | 0.2          |
|    entropy_loss         | -5.61        |
|    explained_variance   | 0.629        |
|    learning_rate        | 0.0003       |
|    loss                 | 3.88         |
|    n_updates            | 90           |
|    policy_gradient_loss | -0.00241     |
|    std                  | 0.984        |
|    value_loss           | 8.49         |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 500          |
|    ep_rew_mean          | -122         |
| time/                   |              |
|    fps                  | 245          |
|    iterations           | 11           |
|    time_elapsed         | 1469         |
|    total_timesteps      | 360448       |
| train/                  |              |
|    approx_kl            | 0.0040568924 |
|    clip_fraction        | 0.0241       |
|    clip_range           | 0.2          |
|    entropy_loss         | -5.61        |
|    explained_variance   | 0.718        |
|    learning_rate        | 0.0003       |
|    loss                 | 4.01         |
|    n_updates            | 100          |
|    policy_gradient_loss | -0.0031      |
|    std                  | 0.983        |
|    value_loss           | 7.85         |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 500          |
|    ep_rew_mean          | -116         |
| time/                   |              |
|    fps                  | 245          |
|    iterations           | 12           |
|    time_elapsed         | 1602         |
|    total_timesteps      | 393216       |
| train/                  |              |
|    approx_kl            | 0.0044810185 |
|    clip_fraction        | 0.0257       |
|    clip_range           | 0.2          |
|    entropy_loss         | -5.61        |
|    explained_variance   | 0.723        |
|    learning_rate        | 0.0003       |
|    loss                 | 4.09         |
|    n_updates            | 110          |
|    policy_gradient_loss | -0.00301     |
|    std                  | 0.983        |
|    value_loss           | 8.53         |
------------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 500         |
|    ep_rew_mean          | -112        |
| time/                   |             |
|    fps                  | 245         |
|    iterations           | 13          |
|    time_elapsed         | 1734        |
|    total_timesteps      | 425984      |
| train/                  |             |
|    approx_kl            | 0.005226965 |
|    clip_fraction        | 0.0421      |
|    clip_range           | 0.2         |
|    entropy_loss         | -5.6        |
|    explained_variance   | 0.764       |
|    learning_rate        | 0.0003      |
|    loss                 | 3.45        |
|    n_updates            | 120         |
|    policy_gradient_loss | -0.00389    |
|    std                  | 0.981       |
|    value_loss           | 7.26        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 500         |
|    ep_rew_mean          | -107        |
| time/                   |             |
|    fps                  | 245         |
|    iterations           | 14          |
|    time_elapsed         | 1866        |
|    total_timesteps      | 458752      |
| train/                  |             |
|    approx_kl            | 0.008871527 |
|    clip_fraction        | 0.078       |
|    clip_range           | 0.2         |
|    entropy_loss         | -5.59       |
|    explained_variance   | 0.775       |
|    learning_rate        | 0.0003      |
|    loss                 | 3.45        |
|    n_updates            | 130         |
|    policy_gradient_loss | -0.00551    |
|    std                  | 0.978       |
|    value_loss           | 6.83        |
-----------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 500          |
|    ep_rew_mean          | -102         |
| time/                   |              |
|    fps                  | 245          |
|    iterations           | 15           |
|    time_elapsed         | 1998         |
|    total_timesteps      | 491520       |
| train/                  |              |
|    approx_kl            | 0.0072622295 |
|    clip_fraction        | 0.0928       |
|    clip_range           | 0.2          |
|    entropy_loss         | -5.58        |
|    explained_variance   | 0.762        |
|    learning_rate        | 0.0003       |
|    loss                 | 3.08         |
|    n_updates            | 140          |
|    policy_gradient_loss | -0.0073      |
|    std                  | 0.974        |
|    value_loss           | 6.67         |
------------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 500         |
|    ep_rew_mean          | -90.4       |
| time/                   |             |
|    fps                  | 245         |
|    iterations           | 16          |
|    time_elapsed         | 2131        |
|    total_timesteps      | 524288      |
| train/                  |             |
|    approx_kl            | 0.006703717 |
|    clip_fraction        | 0.077       |
|    clip_range           | 0.2         |
|    entropy_loss         | -5.56       |
|    explained_variance   | 0.783       |
|    learning_rate        | 0.0003      |
|    loss                 | 2.69        |
|    n_updates            | 150         |
|    policy_gradient_loss | -0.00702    |
|    std                  | 0.97        |
|    value_loss           | 5.85        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 500         |
|    ep_rew_mean          | -84.3       |
| time/                   |             |
|    fps                  | 246         |
|    iterations           | 17          |
|    time_elapsed         | 2263        |
|    total_timesteps      | 557056      |
| train/                  |             |
|    approx_kl            | 0.013680436 |
|    clip_fraction        | 0.173       |
|    clip_range           | 0.2         |
|    entropy_loss         | -5.54       |
|    explained_variance   | 0.821       |
|    learning_rate        | 0.0003      |
|    loss                 | 2.07        |
|    n_updates            | 160         |
|    policy_gradient_loss | -0.00361    |
|    std                  | 0.965       |
|    value_loss           | 4.01        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 500         |
|    ep_rew_mean          | -77.5       |
| time/                   |             |
|    fps                  | 245         |
|    iterations           | 18          |
|    time_elapsed         | 2398        |
|    total_timesteps      | 589824      |
| train/                  |             |
|    approx_kl            | 0.015142741 |
|    clip_fraction        | 0.169       |
|    clip_range           | 0.2         |
|    entropy_loss         | -5.52       |
|    explained_variance   | 0.823       |
|    learning_rate        | 0.0003      |
|    loss                 | 1.94        |
|    n_updates            | 170         |
|    policy_gradient_loss | -0.00541    |
|    std                  | 0.957       |
|    value_loss           | 3.61        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 500         |
|    ep_rew_mean          | -74.6       |
| time/                   |             |
|    fps                  | 245         |
|    iterations           | 19          |
|    time_elapsed         | 2531        |
|    total_timesteps      | 622592      |
| train/                  |             |
|    approx_kl            | 0.024663635 |
|    clip_fraction        | 0.192       |
|    clip_range           | 0.2         |
|    entropy_loss         | -5.48       |
|    explained_variance   | 0.859       |
|    learning_rate        | 0.0003      |
|    loss                 | 1.44        |
|    n_updates            | 180         |
|    policy_gradient_loss | -0.00446    |
|    std                  | 0.949       |
|    value_loss           | 3           |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 500         |
|    ep_rew_mean          | -71.7       |
| time/                   |             |
|    fps                  | 245         |
|    iterations           | 20          |
|    time_elapsed         | 2665        |
|    total_timesteps      | 655360      |
| train/                  |             |
|    approx_kl            | 0.013382119 |
|    clip_fraction        | 0.19        |
|    clip_range           | 0.2         |
|    entropy_loss         | -5.45       |
|    explained_variance   | 0.839       |
|    learning_rate        | 0.0003      |
|    loss                 | 1.22        |
|    n_updates            | 190         |
|    policy_gradient_loss | -0.0057     |
|    std                  | 0.943       |
|    value_loss           | 2.46        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 500         |
|    ep_rew_mean          | -64.5       |
| time/                   |             |
|    fps                  | 245         |
|    iterations           | 21          |
|    time_elapsed         | 2799        |
|    total_timesteps      | 688128      |
| train/                  |             |
|    approx_kl            | 0.017434217 |
|    clip_fraction        | 0.213       |
|    clip_range           | 0.2         |
|    entropy_loss         | -5.41       |
|    explained_variance   | 0.834       |
|    learning_rate        | 0.0003      |
|    loss                 | 1.07        |
|    n_updates            | 200         |
|    policy_gradient_loss | -0.00655    |
|    std                  | 0.931       |
|    value_loss           | 2.28        |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 500        |
|    ep_rew_mean          | -62        |
| time/                   |            |
|    fps                  | 245        |
|    iterations           | 22         |
|    time_elapsed         | 2933       |
|    total_timesteps      | 720896     |
| train/                  |            |
|    approx_kl            | 0.01305098 |
|    clip_fraction        | 0.198      |
|    clip_range           | 0.2        |
|    entropy_loss         | -5.36      |
|    explained_variance   | 0.804      |
|    learning_rate        | 0.0003     |
|    loss                 | 0.985      |
|    n_updates            | 210        |
|    policy_gradient_loss | -0.00446   |
|    std                  | 0.92       |
|    value_loss           | 2.15       |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 500         |
|    ep_rew_mean          | -59.8       |
| time/                   |             |
|    fps                  | 245         |
|    iterations           | 23          |
|    time_elapsed         | 3068        |
|    total_timesteps      | 753664      |
| train/                  |             |
|    approx_kl            | 0.011315527 |
|    clip_fraction        | 0.172       |
|    clip_range           | 0.2         |
|    entropy_loss         | -5.33       |
|    explained_variance   | 0.852       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.923       |
|    n_updates            | 220         |
|    policy_gradient_loss | -0.00556    |
|    std                  | 0.913       |
|    value_loss           | 1.77        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 500         |
|    ep_rew_mean          | -57.5       |
| time/                   |             |
|    fps                  | 245         |
|    iterations           | 24          |
|    time_elapsed         | 3202        |
|    total_timesteps      | 786432      |
| train/                  |             |
|    approx_kl            | 0.016167738 |
|    clip_fraction        | 0.214       |
|    clip_range           | 0.2         |
|    entropy_loss         | -5.29       |
|    explained_variance   | 0.845       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.77        |
|    n_updates            | 230         |
|    policy_gradient_loss | -0.00565    |
|    std                  | 0.905       |
|    value_loss           | 1.51        |
-----------------------------------------
Eval num_timesteps=800000, episode_reward=-37.56 +/- 1.61
Episode length: 500.00 +/- 0.00
-----------------------------------------
| eval/                   |             |
|    mean_ep_length       | 500         |
|    mean_reward          | -37.6       |
| time/                   |             |
|    total_timesteps      | 800000      |
| train/                  |             |
|    approx_kl            | 0.023971198 |
|    clip_fraction        | 0.225       |
|    clip_range           | 0.2         |
|    entropy_loss         | -5.25       |
|    explained_variance   | 0.822       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.621       |
|    n_updates            | 240         |
|    policy_gradient_loss | -0.00319    |
|    std                  | 0.894       |
|    value_loss           | 1.28        |
-----------------------------------------
New best mean reward!
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 500      |
|    ep_rew_mean     | -55      |
| time/              |          |
|    fps             | 234      |
|    iterations      | 25       |
|    time_elapsed    | 3498     |
|    total_timesteps | 819200   |
---------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 500         |
|    ep_rew_mean          | -52.7       |
| time/                   |             |
|    fps                  | 234         |
|    iterations           | 26          |
|    time_elapsed         | 3634        |
|    total_timesteps      | 851968      |
| train/                  |             |
|    approx_kl            | 0.017531168 |
|    clip_fraction        | 0.217       |
|    clip_range           | 0.2         |
|    entropy_loss         | -5.19       |
|    explained_variance   | 0.832       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.498       |
|    n_updates            | 250         |
|    policy_gradient_loss | -0.00585    |
|    std                  | 0.881       |
|    value_loss           | 1.07        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 500         |
|    ep_rew_mean          | -49.8       |
| time/                   |             |
|    fps                  | 234         |
|    iterations           | 27          |
|    time_elapsed         | 3770        |
|    total_timesteps      | 884736      |
| train/                  |             |
|    approx_kl            | 0.012944175 |
|    clip_fraction        | 0.185       |
|    clip_range           | 0.2         |
|    entropy_loss         | -5.14       |
|    explained_variance   | 0.852       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.423       |
|    n_updates            | 260         |
|    policy_gradient_loss | -0.00672    |
|    std                  | 0.871       |
|    value_loss           | 1.01        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 500         |
|    ep_rew_mean          | -47         |
| time/                   |             |
|    fps                  | 234         |
|    iterations           | 28          |
|    time_elapsed         | 3907        |
|    total_timesteps      | 917504      |
| train/                  |             |
|    approx_kl            | 0.011296821 |
|    clip_fraction        | 0.172       |
|    clip_range           | 0.2         |
|    entropy_loss         | -5.1        |
|    explained_variance   | 0.867       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.49        |
|    n_updates            | 270         |
|    policy_gradient_loss | -0.00584    |
|    std                  | 0.861       |
|    value_loss           | 1.01        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 496         |
|    ep_rew_mean          | -43         |
| time/                   |             |
|    fps                  | 234         |
|    iterations           | 29          |
|    time_elapsed         | 4044        |
|    total_timesteps      | 950272      |
| train/                  |             |
|    approx_kl            | 0.022435328 |
|    clip_fraction        | 0.204       |
|    clip_range           | 0.2         |
|    entropy_loss         | -5.05       |
|    explained_variance   | 0.864       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.439       |
|    n_updates            | 280         |
|    policy_gradient_loss | -0.00382    |
|    std                  | 0.852       |
|    value_loss           | 0.875       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 492         |
|    ep_rew_mean          | -39.3       |
| time/                   |             |
|    fps                  | 235         |
|    iterations           | 30          |
|    time_elapsed         | 4181        |
|    total_timesteps      | 983040      |
| train/                  |             |
|    approx_kl            | 0.022363845 |
|    clip_fraction        | 0.268       |
|    clip_range           | 0.2         |
|    entropy_loss         | -5.03       |
|    explained_variance   | 0.333       |
|    learning_rate        | 0.0003      |
|    loss                 | 14.7        |
|    n_updates            | 290         |
|    policy_gradient_loss | -0.000596   |
|    std                  | 0.847       |
|    value_loss           | 12          |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 496         |
|    ep_rew_mean          | -40.1       |
| time/                   |             |
|    fps                  | 235         |
|    iterations           | 31          |
|    time_elapsed         | 4318        |
|    total_timesteps      | 1015808     |
| train/                  |             |
|    approx_kl            | 0.018611912 |
|    clip_fraction        | 0.263       |
|    clip_range           | 0.2         |
|    entropy_loss         | -5          |
|    explained_variance   | 0.291       |
|    learning_rate        | 0.0003      |
|    loss                 | 12.8        |
|    n_updates            | 300         |
|    policy_gradient_loss | -0.00148    |
|    std                  | 0.841       |
|    value_loss           | 11.8        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 499         |
|    ep_rew_mean          | -38.4       |
| time/                   |             |
|    fps                  | 235         |
|    iterations           | 32          |
|    time_elapsed         | 4457        |
|    total_timesteps      | 1048576     |
| train/                  |             |
|    approx_kl            | 0.015706323 |
|    clip_fraction        | 0.221       |
|    clip_range           | 0.2         |
|    entropy_loss         | -4.96       |
|    explained_variance   | 0.882       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.257       |
|    n_updates            | 310         |
|    policy_gradient_loss | -0.00404    |
|    std                  | 0.832       |
|    value_loss           | 0.606       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 498         |
|    ep_rew_mean          | -35.1       |
| time/                   |             |
|    fps                  | 235         |
|    iterations           | 33          |
|    time_elapsed         | 4595        |
|    total_timesteps      | 1081344     |
| train/                  |             |
|    approx_kl            | 0.013927627 |
|    clip_fraction        | 0.233       |
|    clip_range           | 0.2         |
|    entropy_loss         | -4.93       |
|    explained_variance   | 0.377       |
|    learning_rate        | 0.0003      |
|    loss                 | 1.9         |
|    n_updates            | 320         |
|    policy_gradient_loss | -0.00187    |
|    std                  | 0.826       |
|    value_loss           | 11.7        |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 495        |
|    ep_rew_mean          | -29.9      |
| time/                   |            |
|    fps                  | 235        |
|    iterations           | 34         |
|    time_elapsed         | 4734       |
|    total_timesteps      | 1114112    |
| train/                  |            |
|    approx_kl            | 0.01908378 |
|    clip_fraction        | 0.215      |
|    clip_range           | 0.2        |
|    entropy_loss         | -4.89      |
|    explained_variance   | 0.324      |
|    learning_rate        | 0.0003     |
|    loss                 | 0.31       |
|    n_updates            | 330        |
|    policy_gradient_loss | -0.00229   |
|    std                  | 0.817      |
|    value_loss           | 11.5       |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 491         |
|    ep_rew_mean          | -28.7       |
| time/                   |             |
|    fps                  | 235         |
|    iterations           | 35          |
|    time_elapsed         | 4872        |
|    total_timesteps      | 1146880     |
| train/                  |             |
|    approx_kl            | 0.024686152 |
|    clip_fraction        | 0.259       |
|    clip_range           | 0.2         |
|    entropy_loss         | -4.86       |
|    explained_variance   | 0.127       |
|    learning_rate        | 0.0003      |
|    loss                 | 21.6        |
|    n_updates            | 340         |
|    policy_gradient_loss | -0.00217    |
|    std                  | 0.814       |
|    value_loss           | 44.4        |
-----------------------------------------
Process ForkServerProcess-17:
Process ForkServerProcess-11:
Traceback (most recent call last):
  File "/homes/av1019/FYP/fyp/one-goal/reinforcement-learning/PPO/hp_tuning/run_agent.py", line 38, in <module>
The X11 connection broke (error 1). Did the X11 server die?
Process ForkServerProcess-1:
Process ForkServerProcess-14:
The X11 connection broke (error 1). Did the X11 server die?
The X11 connection broke (error 1). Did the X11 server die?
The X11 connection broke (error 1). Did the X11 server die?
The X11 connection broke (error 1). Did the X11 server die?
The X11 connection broke (error 1). Did the X11 server die?
The X11 connection broke (error 1). Did the X11 server die?
The X11 connection broke (error 1). Did the X11 server die?
Process ForkServerProcess-3:
The X11 connection broke (error 1). Did the X11 server die?
Process ForkServerProcess-5:
The X11 connection broke (error 1). Did the X11 server die?
The X11 connection broke (error 1). Did the X11 server die?
    train(scene_file_name=scene_file_name,
  File "/homes/av1019/FYP/fyp/one-goal/reinforcement-learning/PPO/hp_tuning/reinforcement_learning.py", line 111, in train
The X11 connection broke (error 1). Did the X11 server die?
The X11 connection broke (error 1). Did the X11 server die?
The X11 connection broke (error 1). Did the X11 server die?
The X11 connection broke (error 1). Did the X11 server die?
The X11 connection broke (error 1). Did the X11 server die?
The X11 connection broke (error 1). Did the X11 server die?
    # model.learn(total_timesteps=int(timesteps), callback=[eval_callback], reset_num_timesteps=False)
  File "/vol/bitbucket/av1019/fypenv/lib/python3.10/site-packages/stable_baselines3/ppo/ppo.py", line 308, in learn
    return super().learn(
  File "/vol/bitbucket/av1019/fypenv/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 259, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/vol/bitbucket/av1019/fypenv/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 178, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File "/vol/bitbucket/av1019/fypenv/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 171, in step
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/vol/bitbucket/av1019/fypenv/lib/python3.10/site-packages/stable_baselines3/common/vec_env/subproc_vec_env.py", line 34, in _worker
    cmd, data = remote.recv()
  File "/usr/lib/python3.10/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/usr/lib/python3.10/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/usr/lib/python3.10/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt
initialising robot env...
    return self.step_wait()
  File "/vol/bitbucket/av1019/fypenv/lib/python3.10/site-packages/stable_baselines3/common/vec_env/subproc_vec_env.py", line 133, in step_wait
    results = [remote.recv() for remote in self.remotes]
  File "/vol/bitbucket/av1019/fypenv/lib/python3.10/site-packages/stable_baselines3/common/vec_env/subproc_vec_env.py", line 133, in <listcomp>
    results = [remote.recv() for remote in self.remotes]
  File "/usr/lib/python3.10/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/usr/lib/python3.10/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/usr/lib/python3.10/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt
Exception ignored in atexit callback: <function _exit_function at 0x7f00b30b9f30>
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/util.py", line 357, in _exit_function
  File "/usr/lib/python3.10/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/usr/lib/python3.10/multiprocessing/popen_fork.py", line 43, in wait
    return self.poll(os.WNOHANG if timeout == 0.0 else 0)
  File "/usr/lib/python3.10/multiprocessing/popen_forkserver.py", line 65, in poll
    if not wait([self.sentinel], timeout):
  File "/usr/lib/python3.10/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/usr/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt: 
QMutex: destroying locked mutex
QMutex: destroying locked mutex
QMutex: destroying locked mutex
QMutex: destroying locked mutex
QMutex: destroying locked mutex
QMutex: destroying locked mutex
QMutex: destroying locked mutex
QMutex: destroying locked mutex
QMutex: destroying locked mutex
QMutex: destroying locked mutex
QMutex: destroying locked mutex
QMutex: destroying locked mutex
QMutex: destroying locked mutex
QMutex: destroying locked mutex
QMutex: destroying locked mutex
QMutex: destroying locked mutex
